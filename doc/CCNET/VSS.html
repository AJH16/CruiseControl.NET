<html>
    <head>
        <title>CruiseControl.NET : VSS</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            CruiseControl.NET : VSS
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Apr 22, 2004 by <font color="#0050B2">orogers</font>.
				    </div>

				    <p class="paragraph"><h3 class="heading3"> VSS Configuration Examples</h3>
For Visual Source Safe you must specify the executable, project, username and password. You may also specify the SSDIR. If SSDIR is not set the default or the SSDIR environment variable will be used.</p><div class="code"><pre>&lt;sourcecontrol type=&quot;vss&quot;&gt;&#10;   &lt;executable&gt;C&#58;&#92;Program Files&#92;Microsoft Visual Studio&#92;VSS&#92;win32&#92;SS.EXE&lt;/executable&gt;&#10;   &lt;project&gt;$/CCNET&lt;/project&gt;&#10;   &lt;username&gt;buildguy&lt;/username&gt;&#10;   &lt;password&gt;buildguypw&lt;/password&gt;&#10;   &lt;ssdir&gt;c&#58;&#92;repos&#92;&lt;/ssdir&gt;&#10;&lt;/sourcecontrol&gt;</pre></div>
<ul class="star">
<li> project: the root project that CCNet should monitor</li>
<li> username: the VSS userid that be used to log into VSS</li>
<li> password: the password of the above user</li>
<li> ssdir (<em class="emphasis">optional</em>): this value sets the SSDIR environment variable which is used to specify the location of the SRCSAFE.INI file.  If this environment variable is already set on the integration server then this property can be omitted.</li>
<li> executable (<em class="emphasis">optional</em>): this property points to the location of the SS.EXE executable.  If VSS is installed on the integration server, the location of VSS will be read from the registry and this element can be omitted.</li>
<li> timeout (<em class="emphasis">optional</em>): this is how long (in milliseconds) the VSS operation will be permitted to run before timing out.  The default value is 10 minutes.</li>
</ul>
<h3 class="heading3"> VSS Issues</h3><p class="paragraph"><b class="strong">CCNet periodically reports the following error when connecting to VSS: &quot;Unable to open user login file \SourceSafe\Vss60\data\loggedin\&lt;userid&gt;.log.&quot;  What gives?</b></p>If you have set CCNet up to manage multiple projects that all connect to the VSS repository using the same user id then you may sporadically receive this failure.  Our analysis suggests that the root of the problem is caused by the fact that VSS will create the <b class="strong">&lt;userid&gt;.log</b> file when a user logs into VSS and delete it when the user logs out again.  If a second build is using the repository concurrently with the same user, when that second build logs out it looks for <b class="strong">&lt;userid&gt;.log</b>, but it&#039;s gone.  Hence the error.<p class="paragraph">There are three approaches that you can take to deal with this:<ul class="star">
<li> You can <a href="ProjectExceptions.html">keep CCNet from publishing exceptions</a>, so this exception will just get logged into the <b class="strong">ccnet.log</b> file.</li>
<li> Leave the VSS GUI open on the integration server.  This will mean the <b class="strong">userid.log</b> file never gets deleted.</li>
<li> Log into VSS using different users for each CCNet project</li>
</ul></p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Apr 23, 2004 00:07</font></td>
		    </tr>
	    </table>
    </body>
</html>