<html>
    <head>
        <title>CruiseControl.NET : CVS</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            CruiseControl.NET : CVS
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on May 31, 2004 by <font color="#0050B2">orogers</font>.
				    </div>

				    <p class="paragraph"><h3 class="heading3"> CVS Configuration Examples</h3></p>For cvs you must define where the cvs executable (if you give a relative path, it must be relative to the ccnet.exe application) is and the working directory for checked out code. You may optionally specify the cvsroot.<p class="paragraph"><em class="emphasis">example using pserver authentication</em></p><div class="code"><pre>&lt;sourcecontrol type=&quot;cvs&quot;&gt;&#10;   &lt;executable&gt;..&#92;tools&#92;cvs.exe&lt;/executable&gt;&#10;   &lt;workingDirectory&gt;c&#58;&#92;projects&#92;ccnet&lt;/workingDirectory&gt;&#10;   &lt;cvsroot&gt;&#58;pserver&#58;anonymous&#64;cvs.sourceforge.net&#58;/cvsroot/ccnet&lt;/cvsroot&gt;&#10;&lt;/sourcecontrol&gt;</pre></div><p class="paragraph"><em class="emphasis">example using ssh via putty</em></p><div class="code"><pre>&lt;sourcecontrol type=&quot;cvs&quot;&gt;&#10;   &lt;executable&gt;c&#58;&#92;putty&#92;cvswithplinkrsh.bat&lt;/executable&gt;&#10;   &lt;workingDirectory&gt;c&#58;&#92;fromcvs&#92;myrepo&lt;/workingDirectory&gt;&#10;   &lt;cvsroot&gt;&#58;ext&#58;mycvsserver&#58;/cvsroot/myrepo&lt;/cvsroot&gt;&#10;&lt;/sourcecontrol&gt;</pre></div><p class="paragraph"><h3 class="heading3"> Configuration Elements:</h3></p><table class="wikitable">
<tr>
<th> Node </th><th> Description </th><th> Type </th><th> Required</th>
</tr><tr>
<td> executable </td><td> The location of the cvs.exe executable. </td><td> string </td><td> true </td>
</tr><tr>
<td> cvsroot </td><td> The cvs connection string. If this is unspecified, the default value will be read from the CVS\Root file. </td><td> string </td><td> false </td>
</tr><tr>
<td> workingDirectory </td><td> The folder that the source has been checked out into. </td><td> string </td><td> true </td>
</tr><tr>
<td> labelOnSuccess </td><td> Specifies whether or not the repository should be labelled after a successful build </td><td> bool </td><td> false </td>
</tr><tr>
<td> restrictLogins </td><td> Only list modifications checked in by specified logins </td><td> string </td><td> false </td>
</tr><tr>
<td> webUrlBuilder </td><td> The url for the ViewCVS server. </td><td> string </td><td> false </td>
</tr><tr>
<td> branch </td><td> The branch to check for modifications on. </td><td> string </td><td> false </td>
</tr><tr>
<td> autoGetSource </td><td> Specifies whether the current version of the source should be retrieved from VSS.  The default value for this setting is false. </td><td> bool </td><td> false </td>
</tr><tr>
<td> timeout </td><td> How long (in milliseconds) the VSS operation will be permitted to run before timing out.  The default value is 10 minutes. </td><td> int </td><td> false </td>
</tr>
</table>
<h3 class="heading3"> Getting the latest source from CVS</h3>
To have CCNet automatically retrieve the latest version of the source from CVS prior to running a build, you should set the <b class="strong">autoGetSource</b> attribute to <b class="strong">true</b>.  There is one caveat: CCNet cannot yet automatically do a checkout, so the code must be already intially checked out on the integration server for this to work.<p class="paragraph"><h3 class="heading3"> Linking modifications to ViewCVS</h3></p>If you have ViewCVS set up, you can link the modifications detected by CruiseControl.NET to the appropriate ViewCVS page by adding the following additional configuration information to the CVS source control section:

<div class="code"><pre>&lt;webUrlBuilder type=&quot;viewcvs&quot;&gt;&#10;  &lt;url&gt;http&#58;//localhost&#58;7899/viewcvs/ccnet/NUnitDemo/&lt;/url&gt;&#10;&lt;/webUrlBuilder&gt;</pre></div><p class="paragraph">Simply change the <b class="strong">&lt;url&gt;</b> element to point to the root url for your module in ViewCVS.</p><h3 class="heading3"> Using CruiseControl.NET with CVS over SSH</h3><p class="paragraph">Very often when using CVS it is best to use SSH as the authentication/transport protocol. This occurs (for example) if you are using a &#039;SourceForge&#039; or &#039;GForge&#039; instance for your source control. If you are setting up such a scenario, you may want to follow the steps below to help get you going:
<ol>
<li> First you need to decide whether you are going to use password or key based authentication. Using keys is more secure, but using passwords is easier to setup initially. If you are going to use keys, you&#039;ll need to upload your public key to the server - we don&#039;t discuss that here but if you are using SourceForge, see <span class="nobr"><a href="http://sourceforge.net/docman/display_doc.php?docid=766&#38;group_id=1">here<sup><img src="./icons/linkext7.gif" height="7" width="7" align="absmiddle" alt="&gt;&gt;" border="0"/></sup></a></span> for some help.</li>
<li> We are going to use &#039;putty&#039; and &#039;plink&#039; as our SSH client - download them <span class="nobr"><a href="http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html">here<sup><img src="./icons/linkext7.gif" height="7" width="7" align="absmiddle" alt="&gt;&gt;" border="0"/></sup></a></span>. In what follows, we&#039;re going to assume that putty and plink are both available in c:\putty.</li>
<li> Start-up putty and create a session with the following details<br/>
&#8211; a name that we will use later (e.g. &#039;mysourcecontrol&#039;)<br/>
&#8211; SSH protocol<br/>
&#8211; hostname set to the host of your source control server<br/>
&#8211; Set your username in the &#039;auto-login username&#039; box of the &#039;connection&#039; tab<br/>
&#8211; If you are using key-based authentication, setup your key details<br/>
Once you&#039;ve set all these up, save the session, then make sure you can connect (<b class="strong">this is important since we need to allow the remote server&#039;s SSH key</b>)
</li>
<li> We&#039;re going to assume in these steps that you are using the CVS command-line client in the &#039;tools&#039; sub-directory of the CruiseControl home directory, but feel free to use another one of your choice</li>
<li> CVS uses SSH as its transport when the &#039;ext&#039; authentication type is specified in the CVSROOT (we&#039;ll see that later) and the CVS_RSH environment variable points to a SSH cilent. To set the environment variable, you can:<br/>
&#8211; Set it as a system environment variable in Windows<br/>
&#8211; Wrap the cvs.exe file with a batch script, e.g. use the &#039;cvswithplinkrsh.bat&#039; batch file in the tools sub-directory.<br/>
If you are using key-based authentication, set the CVS_RSH variable to be the full path of the &#039;plink.exe&#039; executable. If you are using password-based authentication you&#039;ll need to use another batch file to wrap plink so that you can set the password. An example file is &#039;plinkwithpw.bat&#039; in the tools sub-directory. <b class="strong">Note that you&#039;ll be setting your CVS password in plain-text so you&#039;ll want to keep this file secure.</b>
</li>
<li> Decide where you want your working copy of your source-control project to be located, e.g. &#039;c:\fromcvs\myproject&#039;</li>
<li> Check the project out from source control using the cvs client you are going to use with Cruise Control, e.g. as follows:<br/>
&#8211; cd \fromcvs\myproject<br/>
&#8211; c:\Program Files\CruiseControl.NET\tools\cvswithplinkrsh -d:ext:<b class="strong">mysourcecontrol:/cvsroot/myproject</b> co <b class="strong">mymodule</b><br/>
(here &#039;mysourcecontrol&#039; corresponds to the putty session you setup in step 3, and the other items in bold are the CVS details for your project.
</li>
<li> Now we can setup the CruiseControl.NET config file itself by completing the &lt;sourcecontrol&gt; tag. Here&#039;s an example:
<div class="code"><pre>&lt;sourcecontrol type=&quot;cvs&quot;&gt;&#10;      &lt;executable&gt;c&#58;&#92;Program Files&#92;CruiseControl.NET&#92;tools&#92;cvswithplinkrsh.bat&lt;/executable&gt;&#10;      &lt;workingDirectory&gt;C&#58;&#92;fromcvs&#92;myproject&#92;mymodule&lt;/workingDirectory&gt;&#10;      &lt;cvsroot&gt;&#58;ext&#58;mysourcecontrol&#58;/cvsroot/myproject&lt;/cvsroot&gt;&#10;    &lt;/sourcecontrol&gt;</pre></div>
</li>
<li> The final point to mention is that you will need to use the same kind of setup to checkout the latest code in your actual build file. If you are using a &#039;bootstrap&#039; build file for CruiseControl.NET in your project&#039;s home directory, something like the following might be appropriate:
<div class="code"><pre>&lt;project name=&quot;myproject&#45;ccnet&quot; default=&quot;run&quot;&gt;&#10;  &lt;target name=&quot;run&quot;&gt;&#10;    &lt;exec &#10;        basedir=&quot;.&quot; &#10;        program=&quot;c&#58;&#92;Program Files&#92;CruiseControl.NET&#92;tools&#92;cvswithplinkrsh.bat&quot; &#10;        commandline=&quot;&#45;q update &#45;P &#45;d&quot; &#10;    /&gt;&#10;    &lt;nant buildfile=&quot;myproject.build&quot; /&gt;&#10;  &lt;/target&gt;&#10;&lt;/project&gt;</pre></div>
</li>
</ol></p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on May 31, 2004 05:05</font></td>
		    </tr>
	    </table>
    </body>
</html>